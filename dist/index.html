<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>PROJECT FIDA | ClubSpot</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;700&family=Libre+Barcode+128+Text&display=swap" rel="stylesheet">

    <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    
    <script src="https://accounts.google.com/gsi/client" async defer></script>

    <link rel="stylesheet" href="style.css">

    <script defer src="script.js"></script>
</head>
<body>

  <div id="splashScreen">
    <div class="splash-logo">FIDA</div>
    <div class="splash-loader"></div>
  </div>

  <div id="authScreen" class="auth-wrap hide">
    <div class="auth-bg">
        <img src="https://images.unsplash.com/photo-1497366216548-37526070297c?q=80&w=2069&auto=format&fit=crop" alt="Abstract Office">
        <div class="auth-overlay"></div>
    </div>
    <div class="auth-card">
        <div class="auth-header">
            <div class="auth-logo">FIDA</div>
            <p id="authSubtitle" style="color:var(--text-sec); font-size:1.1rem; font-weight:500;">Access the grid.</p>
        </div>
        <div style="margin-top: 30px; margin-bottom: 20px;">
            <div id="googleBtnContainer"></div>
        </div>
        <p style="text-align:center; font-size:0.8rem; color:var(--text-muted); line-height:1.5;">
            By entering the system, you agree to the<br>Protocol Standards & Data Policy.
        </p>
    </div>
  </div>

  <header class="app-header">
    <a href="#" class="brand">
      <div class="brand-mark"></div>
      FIDA
    </a>
    <div class="user-pill" onclick="switchView('settings', document.querySelector('.dock-item:last-child'))">
        <span id="headerName">GUEST</span>
        <div class="avatar-circle" id="headerAvatar">G</div>
    </div>
  </header>

  <div id="viewHome" class="view-section active">
    <section class="hero">
        <div class="hero-card">
            <div class="hero-shine"></div>
            <img src="https://images.unsplash.com/photo-1492684223066-81342ee5ff30?q=80&w=2070&auto=format&fit=crop" class="hero-bg" alt="Event">
            <div class="hero-overlay"></div>
            <div class="hero-content">
                <div class="live-badge"><div class="pulse-dot"></div> LIVE NOW</div>
                <h2 class="hero-title">NEON<br>HORIZON</h2>
                <p class="hero-desc">The underground racing season finale. Don't miss the start.</p>
            </div>
        </div>
    </section>

    <div class="search-wrap">
        <div class="search-bar">
            <svg class="icon icon-sm" viewBox="0 0 24 24" style="color:var(--text-muted)"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
            <input type="text" id="searchInput" class="search-input" placeholder="Search events..." onkeyup="handleSearch(this.value)">
        </div>
    </div>

    <div id="clubsContainer" class="feed"></div>
  </div>

  <div id="viewPasses" class="view-section">
      <div style="padding: 20px; font-size:1.8rem; font-weight:800; letter-spacing:-0.03em;">My Passes</div>
      <div id="passesContainer" class="feed"></div>
  </div>

  <div id="viewHost" class="view-section">
      <div style="display:flex; justify-content:space-between; align-items:center; padding:20px;">
          <div style="font-size:1.8rem; font-weight:800; letter-spacing:-0.03em;">Host Dashboard</div>
          <button onclick="startScanner()" style="background:var(--text-main); color:white; border:none; width:44px; height:44px; border-radius:50%; display:flex; align-items:center; justify-content:center; cursor:pointer;">
              <svg class="icon" viewBox="0 0 24 24"><path d="M3 7V5a2 2 0 0 1 2-2h2"></path><path d="M17 3h2a2 2 0 0 1 2 2v2"></path><path d="M21 17v2a2 2 0 0 1-2 2h-2"></path><path d="M7 21H5a2 2 0 0 1-2-2v-2"></path></svg>
          </button>
      </div>
      <div id="hostContainer" class="feed"></div>
  </div>

  <div id="viewSettings" class="view-section">
      <div style="padding: 20px; font-size:1.8rem; font-weight:800; letter-spacing:-0.03em;">Settings</div>
      <div style="padding: 0 20px;">
          <div style="background: white; border-radius: 24px; padding: 24px; text-align: center; border: 1px solid var(--border); box-shadow: var(--shadow-sm); margin-bottom: 24px;">
              <div style="width: 80px; height: 80px; background: var(--bg-dots); border-radius: 50%; margin: 0 auto 16px; display: flex; align-items: center; justify-content: center; font-size: 2rem; font-weight: 700; overflow:hidden;" id="settingsAvatar"></div>
              <h3 id="settingsName" style="font-size: 1.4rem; margin-bottom: 4px; font-weight:700;"></h3>
              <p id="settingsEmail" style="color: var(--text-sec); font-family: var(--font-mono); font-size: 0.9rem; margin-bottom: 16px;"></p>
          </div>
          <div style="background: white; border-radius: 24px; overflow: hidden; border: 1px solid var(--border);">
               <div onclick="logout()" style="padding: 16px 20px; color: #ef4444; font-weight: 700; cursor: pointer; display: flex; align-items: center; justify-content: space-between;">
                  <span>Log Out</span>
                  <svg class="icon" viewBox="0 0 24 24"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>
              </div>
          </div>
      </div>
  </div>

  <div class="dock-container">
    <div class="dock">
        <div class="dock-item active" onclick="switchView('home', this)">
            <svg class="icon" viewBox="0 0 24 24"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
        </div>
        <div class="dock-item" onclick="switchView('passes', this)">
            <svg class="icon" viewBox="0 0 24 24"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
        </div>
        <div class="dock-fab" onclick="openCreateModal()">
            <svg class="icon" viewBox="0 0 24 24" style="stroke:white;"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
        </div>
        <div class="dock-item" onclick="switchView('host', this)">
            <svg class="icon" viewBox="0 0 24 24"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect></svg>
        </div>
        <div class="dock-item" onclick="switchView('settings', this)">
            <svg class="icon" viewBox="0 0 24 24"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
        </div>
    </div>
  </div>

  <div id="scannerModal" class="overlay">
      <div style="width:100%; max-width:400px; padding:20px; position:relative; display:flex; flex-direction:column; align-items:center;">
          <button class="btn-icon-back" onclick="stopScanner()">
            <svg viewBox="0 0 24 24"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
          </button>
          <div id="reader"></div>
          <button onclick="stopScanner()" style="margin-top:20px; width:100%; height:50px; background:white; color:black; border:none; border-radius:12px; font-weight:700;">CANCEL SCAN</button>
      </div>
  </div>

  <div id="scanResultModal" class="overlay">
      <div class="scan-card">
          <div id="scanIcon" class="scan-icon-circle"></div>
          <div id="scanStatus" class="scan-status"></div>
          <div id="scanName" class="scan-name"></div>
          <button onclick="document.getElementById('scanResultModal').classList.remove('visible'); startScanner();" style="margin-top:24px; width:100%; height:50px; background:var(--bg-body); color:var(--text-main); border:none; border-radius:12px; font-weight:700;">SCAN NEXT</button>
          <button onclick="document.getElementById('scanResultModal').classList.remove('visible')" style="margin-top:12px; width:100%; height:50px; background:transparent; color:var(--text-muted); border:none; font-weight:600;">DONE</button>
      </div>
  </div>

  <div id="qrDisplayModal" class="overlay" style="align-items:center; justify-content:center; background:rgba(0,0,0,0.9);">
      <div style="background:white; padding:40px; border-radius:32px; text-align:center; max-width:90%; position:relative;">
          <button onclick="document.getElementById('qrDisplayModal').classList.remove('visible')" style="position:absolute; top:16px; right:16px; background:transparent; border:none; font-weight:700; color:var(--text-muted); cursor:pointer;">CLOSE</button>
          <h3 style="margin-bottom:24px; font-weight:800; font-size:1.5rem;" id="qrModalTitle">SCAN ME</h3>
          <div id="qrModalTarget" style="display:flex; justify-content:center;"></div>
          <p style="margin-top:24px; color:var(--text-sec); font-family:var(--font-mono);" id="qrModalCodeText">CODE</p>
      </div>
  </div>

  <div id="detailsModal" class="overlay">
    <div class="sheet">
        <div class="sheet-handle"></div>
        <div class="sheet-header-sticky">
             <div style="display:flex; align-items:center;">
                 <button onclick="document.getElementById('detailsModal').classList.remove('visible')" style="background:transparent; border:1px solid var(--border); width:40px; height:40px; border-radius:50%; display:flex; align-items:center; justify-content:center; cursor:pointer; color:var(--text-main); margin-right:12px;">
                    <svg class="icon" viewBox="0 0 24 24"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                 </button>
                 <span style="font-weight:700; font-size:0.9rem; color:var(--text-sec);">BACK</span>
            </div>
        </div>
        <div class="sheet-body" id="detailsContent"></div>
    </div>
  </div>

  <div id="hostDetailModal" class="overlay">
    <div class="sheet">
        <div class="sheet-handle"></div>
        <div class="sheet-header-sticky" style="padding-bottom: 10px;">
             <div style="display:flex; align-items:center;">
                 <button onclick="document.getElementById('hostDetailModal').classList.remove('visible')" style="background:transparent; border:1px solid var(--border); width:40px; height:40px; border-radius:50%; display:flex; align-items:center; justify-content:center; cursor:pointer; color:var(--text-main); margin-right:12px;">
                    <svg class="icon" viewBox="0 0 24 24"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                 </button>
                 <span style="font-weight:700; font-size:0.9rem; color:var(--text-sec);">DASHBOARD</span>
            </div>
        </div>
        <div class="sheet-body" id="hostDetailContent" style="padding-top:0;"></div>
    </div>
  </div>

  <div id="createModal" class="overlay">
    <div class="sheet">
        <div class="sheet-handle" id="createHandle"></div>
        <div class="sheet-header-sticky">
            <div style="display:flex; align-items:center; justify-content:space-between; width:100%;">
                 <div style="display:flex; align-items:center;">
                     <button onclick="closeCreateModal()" style="background:transparent; border:1px solid var(--border); width:40px; height:40px; border-radius:50%; display:flex; align-items:center; justify-content:center; cursor:pointer; color:var(--text-main); margin-right:12px;">
                        <svg class="icon" viewBox="0 0 24 24"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                     </button>
                     <span style="font-weight:700; font-size:0.9rem; color:var(--text-sec);">CANCEL</span>
                 </div>
                 <span style="font-weight:800; letter-spacing:-0.03em; font-size:1.1rem;">NEW DROP</span>
                 <div style="width:40px;"></div>
            </div>
        </div>
        <div class="sheet-body">
            <form onsubmit="handleCreate(event)">
                
                <div class="upload-zone" id="uploadZone">
                    <input type="file" id="cImageInput" accept="image/*" onchange="previewImage(this)">
                    <img id="cImagePreview">
                    <div class="upload-placeholder">
                        <div class="upload-icon">
                            <svg class="icon" viewBox="0 0 24 24"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><polyline points="21 15 16 10 5 21"></polyline></svg>
                        </div>
                        <span style="font-weight:600; color:var(--text-main);">Upload Cover</span>
                        <span style="font-size:0.8rem; color:var(--text-muted);">16:9 Recommended</span>
                    </div>
                </div>

                <div class="form-section">
                    <label class="form-label">Event Details</label>
                    <input type="text" id="cName" class="inp" placeholder="Event Title" required style="font-size:1.2rem; font-weight:700; height:72px;">
                    
                    <div class="category-scroll">
                        <input type="hidden" id="cCategory" value="PARTY">
                        <div class="chip active" onclick="selectCategory(this, 'PARTY')">PARTY</div>
                        <div class="chip" onclick="selectCategory(this, 'RACE')">RACE</div>
                        <div class="chip" onclick="selectCategory(this, 'SHOW')">SHOW</div>
                        <div class="chip" onclick="selectCategory(this, 'MEET')">MEET</div>
                    </div>
                </div>

                <div class="form-section">
                    <label class="form-label">Description</label>
                    <textarea id="cDesc" class="inp" style="height:120px; padding-top:18px; resize:none; line-height:1.6;" placeholder="What's the vibe?" required></textarea>
                </div>

                <div class="form-section">
                    <label class="form-label">Logistics</label>
                    <div class="segmented-control">
                        <div class="segment-btn active" id="btnOffline" onclick="setEventMode('offline')">IN PERSON</div>
                        <div class="segment-btn" id="btnOnline" onclick="setEventMode('online')">ONLINE</div>
                    </div>
                    <input type="hidden" id="cMode" value="offline">

                    <div class="grid-2">
                        <div class="inp-group-icon">
                            <svg class="icon-sm" viewBox="0 0 24 24"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
                            <input type="date" id="cDate" class="inp-plain" required>
                        </div>
                        <div class="inp-group-icon">
                            <svg class="icon-sm" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
                            <input type="time" id="cTime" class="inp-plain" required>
                        </div>
                    </div>
                    <div class="inp-group-icon" style="margin-top:12px;">
                        <div id="cLocIcon">
                            <svg class="icon-sm" viewBox="0 0 24 24"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>
                        </div>
                        <input type="text" id="cLoc" class="inp-plain" placeholder="Location" required>
                    </div>
                </div>

                <div class="form-section">
                    <label class="form-label">Access & Capacity</label>
                    <div class="grid-2">
                        <div class="inp-group-icon">
                            <span style="font-weight:700; font-family:var(--font-mono); color:var(--text-muted);">$</span>
                            <input type="number" id="cPrice" class="inp-plain" placeholder="Price">
                        </div>
                        <div class="inp-group-icon">
                            <svg class="icon-sm" viewBox="0 0 24 24"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>
                            <input type="number" id="cMax" class="inp-plain" placeholder="Max People">
                        </div>
                    </div>
                </div>

                <div style="height:20px;"></div>
                <button class="btn-main" type="submit">PUBLISH DROP</button>
            </form>
        </div>
    </div>
  </div>

  <div id="toast" class="toast">
      <div class="toast-icon"></div>
      <span id="toastMsg" style="font-weight:600; font-size:0.95rem;">Notification</span>
  </div>

</body>
</html>